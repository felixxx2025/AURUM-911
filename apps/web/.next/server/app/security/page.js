(()=>{var e={};e.id=127,e.ids=[127],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6059:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.Z,__next_app__:()=>u,originalPathname:()=>d,pages:()=>c,routeModule:()=>h,tree:()=>l}),s(4052),s(3454),s(3805),s(2102),s(7824);var r=s(3282),a=s(5736),i=s(5055),n=s(6880),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let l=["",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4052)),"/root/AURUM-911/apps/web/app/security/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3454)),"/root/AURUM-911/apps/web/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,3805)),"/root/AURUM-911/apps/web/app/error.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,2102)),"/root/AURUM-911/apps/web/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7824,23)),"next/dist/client/components/not-found-error"]}],c=["/root/AURUM-911/apps/web/app/security/page.tsx"],d="/security/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/security/page",pathname:"/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},868:(e,t,s)=>{Promise.resolve().then(s.bind(s,2886))},2886:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(3227),a=s(3677),i=s(5969),n=s(1009),o=s(8693),l=s(7392);function c(){let[e,t]=(0,a.useState)("password"),[s,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[x,f]=(0,a.useState)(""),[p,g]=(0,a.useState)(!1),y=async e=>{e.preventDefault(),g(!0);try{let e=await l.apiClient.enableMFA();u(e?.qrCode||""),m(e?.secret||""),t("qr")}catch(e){console.error("MFA setup error:",e)}finally{g(!1)}},b=async e=>{e.preventDefault(),g(!0);try{await l.apiClient.verifyMFA(x),t("verify")}catch(e){console.error("MFA verification error:",e)}finally{g(!1)}};return(0,r.jsxs)(n.Zb,{className:"w-full max-w-md",children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{children:"Configurar Autentica\xe7\xe3o de Dois Fatores"})}),(0,r.jsxs)(n.aY,{children:["password"===e&&(0,r.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Confirme sua senha"}),r.jsx(o.II,{type:"password",value:s,onChange:e=>c(e.target.value),required:!0})]}),r.jsx(i.zx,{type:"submit",disabled:p,className:"w-full",children:p?"Configurando...":"Continuar"})]}),"qr"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Escaneie o QR Code com seu app autenticador"}),r.jsx("img",{src:d,alt:"QR Code",className:"mx-auto"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Chave manual: ",h]})]}),(0,r.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"C\xf3digo de verifica\xe7\xe3o"}),r.jsx(o.II,{type:"text",value:x,onChange:e=>f(e.target.value),placeholder:"000000",maxLength:6,required:!0})]}),r.jsx(i.zx,{type:"submit",disabled:p,className:"w-full",children:p?"Verificando...":"Verificar e Ativar"})]})]}),"verify"===e&&(0,r.jsxs)("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"text-green-600",children:"✓ MFA configurado com sucesso!"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Sua conta agora est\xe1 protegida com autentica\xe7\xe3o de dois fatores."})]})]})]})}var d=s(75),u=s(2610);function h(){let[e,t]=(0,a.useState)(u.E.getState().user),[s,o]=(0,a.useState)(!1),l=async()=>{let e=prompt("Digite sua senha para desativar MFA:");if(e)try{await u.E.disableMFA(e),alert("MFA desativado com sucesso")}catch(e){alert("Erro ao desativar MFA")}};return(0,r.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Configura\xe7\xf5es de Seguran\xe7a"}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center justify-between",children:["Autentica\xe7\xe3o de Dois Fatores (MFA)",r.jsx(d.C,{variant:e?.mfaEnabled?"default":"secondary",children:e?.mfaEnabled?"Ativado":"Desativado"})]})}),(0,r.jsxs)(n.aY,{children:[r.jsx("p",{className:"text-gray-600 mb-4",children:"Adicione uma camada extra de seguran\xe7a \xe0 sua conta."}),e?.mfaEnabled?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-green-600",children:"✓"}),r.jsx("span",{children:"MFA est\xe1 ativo em sua conta"})]}),r.jsx(i.zx,{variant:"outline",onClick:l,children:"Desativar MFA"})]}):r.jsx("div",{children:s?r.jsx(c,{}):r.jsx(i.zx,{onClick:()=>o(!0),children:"Configurar MFA"})})]})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:r.jsx(n.ll,{children:"Sess\xf5es Ativas"})}),r.jsx(n.aY,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium",children:"Sess\xe3o Atual"}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["\xdaltimo acesso: ",e?.lastLogin?new Date(e.lastLogin).toLocaleString("pt-BR"):"Agora"]})]}),r.jsx(d.C,{variant:"default",children:"Ativa"})]})})]})]})}},5969:(e,t,s)=>{"use strict";s.d(t,{zx:()=>i});var r=s(3227),a=s(1126);s(3677);let i=function({className:e,variant:t="primary",size:s="md",loading:i,children:n,disabled:o,...l}){return(0,r.jsxs)("button",{className:(0,a.W)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-600":"primary"===t||"default"===t,"bg-gray-200 text-gray-900 hover:bg-gray-300 focus-visible:ring-gray-500 border border-gray-300":"secondary"===t||"outline"===t,"hover:bg-gray-100 focus-visible:ring-gray-500":"ghost"===t,"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-600":"danger"===t||"destructive"===t,"h-8 px-3 text-sm":"sm"===s,"h-10 px-4 text-sm":"md"===s,"h-12 px-6 text-base":"lg"===s},e),disabled:o||i,...l,children:[i&&(0,r.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})}},8693:(e,t,s)=>{"use strict";s.d(t,{II:()=>i});var r=s(3227),a=s(1126);s(3677);let i=function({className:e,label:t,error:s,helperText:i,id:n,...o}){let l=n||`input-${Math.random().toString(36).substr(2,9)}`;return(0,r.jsxs)("div",{className:"space-y-1",children:[t&&r.jsx("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700",children:t}),r.jsx("input",{id:l,className:(0,a.W)("block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6",s?"ring-red-300 focus:ring-red-600":"ring-gray-300 focus:ring-blue-600",e),...o}),s&&r.jsx("p",{className:"text-sm text-red-600",children:s}),i&&!s&&r.jsx("p",{className:"text-sm text-gray-500",children:i})]})}},75:(e,t,s)=>{"use strict";s.d(t,{C:()=>a});var r=s(3227);function a({className:e="",...t}){return r.jsx("span",{className:`inline-flex items-center rounded-md bg-gray-100 px-2 py-1 text-xs font-medium text-gray-700 ${e}`,...t})}},1009:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>i,Zb:()=>a,aY:()=>n,ll:()=>o});var r=s(3227);function a({className:e="",...t}){return r.jsx("div",{className:`rounded-lg border border-gray-200 bg-white shadow-sm ${e}`,...t})}function i({className:e="",...t}){return r.jsx("div",{className:`p-4 border-b border-gray-100 ${e}`,...t})}function n({className:e="",...t}){return r.jsx("div",{className:`p-4 ${e}`,...t})}function o({className:e="",...t}){return r.jsx("h3",{className:`text-base font-semibold leading-6 text-gray-900 ${e}`,...t})}},2610:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var r=s(7392);class a{constructor(){this.state={user:null,token:null,refreshToken:null,tenantId:null,isAuthenticated:!1,mfaRequired:!1,sessionExpiry:null},this.refreshTimer=null,this.listeners=[],this.loadFromStorage()}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notify(){this.listeners.forEach(e=>e(this.state))}loadFromStorage(){}sanitizeString(e){return e.replace(/[<>"'&]/g,"")}isValidUser(e){return e&&"string"==typeof e.id&&"string"==typeof e.email}saveToStorage(){}clearStorage(){}async login(e,t,s){try{if(!e||!t)throw Error("Email and password are required");let a=await r.apiClient.login({email:e,password:t,mfaCode:s});if(!a)throw Error("Invalid response from server");if(a.mfaRequired)return this.state={...this.state,mfaRequired:!0,user:a.user},this.notify(),a;if(!a.access_token||!a.user)throw Error("Invalid authentication response");let i=Date.now()+1e3*a.expires_in;return this.state={user:a.user,token:a.access_token,refreshToken:a.refresh_token,tenantId:a.tenant_id,isAuthenticated:!0,mfaRequired:!1,sessionExpiry:i},r.apiClient.setToken(a.access_token),a.tenant_id&&r.apiClient.setTenant(a.tenant_id),this.saveToStorage(),this.scheduleTokenRefresh(),this.notify(),a}catch(e){throw console.error("Login error:",e),this.state={...this.state,mfaRequired:!1,isAuthenticated:!1},this.notify(),e instanceof Error?e:Error("Login failed")}}async logout(){if(this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null),this.state.refreshToken)try{await r.apiClient.logout(this.state.refreshToken)}catch(e){console.warn("Logout error:",e)}this.state={user:null,token:null,refreshToken:null,tenantId:null,isAuthenticated:!1,mfaRequired:!1,sessionExpiry:null},this.saveToStorage(),this.notify()}scheduleTokenRefresh(){if(!this.state.sessionExpiry)return;let e=this.state.sessionExpiry-Date.now()-3e5;e>0&&(this.refreshTimer=setTimeout(()=>{this.refreshToken()},e))}async refreshToken(){if(this.state.refreshToken)try{let e=await r.apiClient.refreshToken(this.state.refreshToken),t=Date.now()+1e3*e.expires_in;this.state={...this.state,token:e.access_token,refreshToken:e.refresh_token||this.state.refreshToken,sessionExpiry:t},r.apiClient.setToken(e.access_token),this.saveToStorage(),this.scheduleTokenRefresh(),this.notify()}catch(e){console.error("Token refresh failed:",e),this.logout()}}async enableMFA(){return await r.apiClient.enableMFA()}async verifyMFA(e){let t=await r.apiClient.verifyMFA(e);return t.success&&this.state.user&&(this.state.user.mfaEnabled=!0,this.saveToStorage(),this.notify()),t}async disableMFA(e){let t=await r.apiClient.disableMFA(e);return t.success&&this.state.user&&(this.state.user.mfaEnabled=!1,this.saveToStorage(),this.notify()),t}getState(){return this.state}}let i=new a},4052:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(3189).createProxy)(String.raw`/root/AURUM-911/apps/web/app/security/page.tsx#default`)},1126:(e,t,s)=>{"use strict";function r(){for(var e,t,s=0,r="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=function e(t){var s,r,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(s=0;s<i;s++)t[s]&&(r=e(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r)}return a}(e))&&(r&&(r+=" "),r+=t);return r}s.d(t,{W:()=>r})}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[522,768,193],()=>s(6059));module.exports=r})();
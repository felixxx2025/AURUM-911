(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[671],{6825:function(e,s,t){Promise.resolve().then(t.bind(t,5536))},5536:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(7573),i=t(9585),r=t(590),l=t(8962);async function n(e,s){let t=new TextEncoder,a=await crypto.subtle.importKey("raw",t.encode(e),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return Array.from(new Uint8Array(await crypto.subtle.sign("HMAC",a,t.encode(s)))).map(e=>e.toString(16).padStart(2,"0")).join("")}function c(){let[e,s]=(0,i.useState)("clicksign"),[t,c]=(0,i.useState)("changeme"),[o,d]=(0,i.useState)([]),[h,x]=(0,i.useState)(!1),[u,g]=(0,i.useState)(!1),[p,m]=(0,i.useState)("webhooks"),[f,y]=(0,i.useState)(null),[v,j]=(0,i.useState)(!1),[b,N]=(0,i.useState)(""),[w,S]=(0,i.useState)(null),[k,C]=(0,i.useState)(null),[I,O]=(0,i.useState)(""),[P,z]=(0,i.useState)(null),A=(0,i.useMemo)(()=>({type:"test.event",id:"evt-"+Math.random().toString(36).slice(2,8),data:{hello:"world"}}),[]),E=async()=>{x(!0);try{let s=Math.floor(Date.now()/1e3).toString(),a="".concat(s,".").concat(JSON.stringify(A)),i=await n(t,a),r="t=".concat(s,",v1=").concat(i),l=await fetch("/integrations/webhooks/".concat(e),{method:"POST",headers:{"content-type":"application/json","x-aurum-signature":r},body:JSON.stringify(A)});await l.json(),await J()}finally{x(!1)}},J=async()=>{g(!0);try{let s=await fetch("/integrations/webhooks/logs?provider=".concat(e,"&limit=50")),t=await s.json();d(t.items||[])}finally{g(!1)}},M=async()=>{j(!0);try{let e=await fetch("/integrations/webhooks/stats"),s=await e.json();y(s||null)}finally{j(!1)}};return(0,i.useEffect)(()=>{J()},[e]),(0,i.useEffect)(()=>{M();let e=setInterval(M,1e4);return()=>clearInterval(e)},[]),(0,a.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Conectores"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Aba de testes com Webhooks, E‑signature (Clicksign), PIX (Stripe) e Open Finance (Belvo)."})]}),(0,a.jsx)("div",{className:"mb-6 flex gap-2 border-b",children:[{id:"webhooks",label:"Webhooks"},{id:"esign",label:"Piloto E‑sign (Clicksign)"},{id:"pix",label:"Piloto PIX (Stripe)"},{id:"openfinance",label:"Open Finance (Belvo)"}].map(e=>(0,a.jsx)("button",{className:"px-3 py-2 text-sm border-b-2 ".concat(p===e.id?"border-indigo-600 text-indigo-700":"border-transparent text-gray-600"),onClick:()=>m(e.id),children:e.label},e.id))}),"webhooks"===p&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:(()=>{let e=(null==f?void 0:f.providers)||{},s=Object.values(e).reduce((e,s)=>({total:e.total+(s.total||0),verified:e.verified+(s.verified||0),unverified:e.unverified+(s.unverified||0)}),{total:0,verified:0,unverified:0});return[{label:"Eventos totais",value:s.total},{label:"Verificados",value:s.verified},{label:"N\xe3o verificados",value:s.unverified},{label:"Providers ativos",value:Object.keys(e).length}].map(e=>(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.label}),(0,a.jsx)("div",{className:"mt-1 text-2xl font-semibold text-gray-900",children:v?"...":e.value})]},e.label))})()}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(l.II,{label:"Provider",value:e,onChange:e=>s(e.target.value),placeholder:"ex: clicksign, stripe, belvo, idwall"}),(0,a.jsx)(l.II,{label:"Webhook Secret (local)",value:t,onChange:e=>c(e.target.value),placeholder:"segredo para assinar payload"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.zx,{onClick:E,loading:h,children:"Enviar teste"}),(0,a.jsx)(r.zx,{variant:"secondary",onClick:J,loading:u,children:"Atualizar logs"}),(0,a.jsx)(r.zx,{variant:"secondary",onClick:M,loading:v,children:"Atualizar KPIs"})]})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"KPIs por provider"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left text-gray-500",children:[(0,a.jsx)("th",{className:"py-2 pr-4",children:"Provider"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"Total"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"Verificados"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"N\xe3o verificados"})]})}),(0,a.jsxs)("tbody",{children:[Object.entries((null==f?void 0:f.providers)||{}).map(e=>{let[s,t]=e;return(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"py-2 pr-4 font-mono",children:s}),(0,a.jsx)("td",{className:"py-2 pr-4",children:t.total}),(0,a.jsx)("td",{className:"py-2 pr-4",children:t.verified}),(0,a.jsx)("td",{className:"py-2 pr-4",children:t.unverified})]},s)}),0===Object.keys((null==f?void 0:f.providers)||{}).length&&(0,a.jsx)("tr",{className:"border-t",children:(0,a.jsx)("td",{className:"py-3 text-gray-500",colSpan:4,children:"Sem dados ainda."})})]})]})})]}),(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Logs recebidos"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-left text-gray-500",children:[(0,a.jsx)("th",{className:"py-2 pr-4",children:"ID"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"Quando"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"Provider"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"Verificado"}),(0,a.jsx)("th",{className:"py-2 pr-4",children:"Assinatura"})]})}),(0,a.jsx)("tbody",{children:o.map(e=>(0,a.jsxs)("tr",{className:"border-t",children:[(0,a.jsx)("td",{className:"py-2 pr-4 font-mono",children:e.id}),(0,a.jsx)("td",{className:"py-2 pr-4",children:new Date(e.receivedAt).toLocaleString()}),(0,a.jsx)("td",{className:"py-2 pr-4",children:e.provider}),(0,a.jsx)("td",{className:"py-2 pr-4",children:(0,a.jsx)("span",{className:"px-2 py-0.5 rounded text-xs ".concat(e.verified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:String(e.verified)})}),(0,a.jsx)("td",{className:"py-2 pr-4 truncate max-w-[240px] font-mono",children:e.signature||"-"})]},e.id))})]})})]})]}),"esign"===p&&(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Piloto E‑sign (Clicksign)"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(0,a.jsx)(l.II,{label:"Document ID",value:b,onChange:e=>N(e.target.value),placeholder:"doc-123"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.zx,{onClick:async()=>{let e=await fetch("/pilot/e-sign/clicksign/start",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({documentId:b||"doc-sample"})});S(await e.json())},children:"Iniciar assinatura"}),(0,a.jsx)(r.zx,{variant:"secondary",onClick:async()=>{if(!(null==w?void 0:w.id))return;let e=await fetch("/pilot/e-sign/clicksign/".concat(w.id,"/status"));S(await e.json())},children:"Atualizar status"})]}),w&&(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-auto",children:JSON.stringify(w,null,2)})]}),"pix"===p&&(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Piloto PIX (Stripe)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.zx,{onClick:async()=>{let e=await fetch("/pilot/payments/stripe/pix-charge",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({amount:101,currency:"BRL"})});C(await e.json())},children:"Criar cobran\xe7a PIX"}),(0,a.jsx)(r.zx,{variant:"secondary",onClick:async()=>{if(!(null==k?void 0:k.id))return;let e=await fetch("/pilot/payments/charge/".concat(k.id));C(await e.json())},children:"Atualizar status"})]}),k&&(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-auto",children:JSON.stringify(k,null,2)})]}),"openfinance"===p&&(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Open Finance (Belvo)"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(0,a.jsx)(l.II,{label:"User ID",value:I,onChange:e=>O(e.target.value),placeholder:"user-123"})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.zx,{onClick:async()=>{let e=await fetch("/pilot/open-finance/belvo/consent",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({userId:I||"user-sample"})});z(await e.json())},children:"Criar consentimento"}),(0,a.jsx)(r.zx,{variant:"secondary",onClick:async()=>{if(!(null==P?void 0:P.id))return;let e=await fetch("/pilot/open-finance/consent/".concat(P.id));z(await e.json())},children:"Atualizar status"})]}),P&&(0,a.jsx)("pre",{className:"bg-gray-50 rounded p-3 text-xs overflow-auto",children:JSON.stringify(P,null,2)})]})]})}},590:function(e,s,t){"use strict";t.d(s,{zx:function(){return r}});var a=t(7573),i=t(607);t(9585);let r=function(e){let{className:s,variant:t="primary",size:r="md",loading:l,children:n,disabled:c,...o}=e;return(0,a.jsxs)("button",{className:(0,i.W)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-600":"primary"===t||"default"===t,"bg-gray-200 text-gray-900 hover:bg-gray-300 focus-visible:ring-gray-500 border border-gray-300":"secondary"===t||"outline"===t,"hover:bg-gray-100 focus-visible:ring-gray-500":"ghost"===t,"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-600":"danger"===t||"destructive"===t,"h-8 px-3 text-sm":"sm"===r,"h-10 px-4 text-sm":"md"===r,"h-12 px-6 text-base":"lg"===r},s),disabled:c||l,...o,children:[l&&(0,a.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})}},8962:function(e,s,t){"use strict";t.d(s,{II:function(){return r}});var a=t(7573),i=t(607);t(9585);let r=function(e){let{className:s,label:t,error:r,helperText:l,id:n,...c}=e,o=n||"input-".concat(Math.random().toString(36).substr(2,9));return(0,a.jsxs)("div",{className:"space-y-1",children:[t&&(0,a.jsx)("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700",children:t}),(0,a.jsx)("input",{id:o,className:(0,i.W)("block w-full rounded-md border-0 py-1.5 px-3 text-gray-900 shadow-sm ring-1 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6",r?"ring-red-300 focus:ring-red-600":"ring-gray-300 focus:ring-blue-600",s),...c}),r&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:r}),l&&!r&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:l})]})}},607:function(e,s,t){"use strict";function a(){for(var e,s,t=0,a="",i=arguments.length;t<i;t++)(e=arguments[t])&&(s=function e(s){var t,a,i="";if("string"==typeof s||"number"==typeof s)i+=s;else if("object"==typeof s){if(Array.isArray(s)){var r=s.length;for(t=0;t<r;t++)s[t]&&(a=e(s[t]))&&(i&&(i+=" "),i+=a)}else for(a in s)s[a]&&(i&&(i+=" "),i+=a)}return i}(e))&&(a&&(a+=" "),a+=s);return a}t.d(s,{W:function(){return a}})}},function(e){e.O(0,[293,528,744],function(){return e(e.s=6825)}),_N_E=e.O()}]);